var PusherTest = {
  get_pusher: function () {
    var pusher = new Pusher('<%=ENV['PUSHER_APP_KEY']%>');
    return function () {return pusher;}
  },
  setup: function () {
    var get_pusher = PusherTest.get_pusher();
    var pusher = get_pusher();
    var channel = pusher.subscribe('my_channel');
    channel.bind('new_message', function(data) {
      alert('From: ' + data.name + ', Message: ' + data.message);
    });
    var channel = pusher.subscribe('pusher_test');
    channel.bind('js_register', function(data) {
      alert('Job Seeker: ' + data.name + ' has joined PETS');
    });
  }
};

$(PusherTest.setup);
